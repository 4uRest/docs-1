## dash.getAnalytics: Статистика по продажам

>  Пример запроса:

```php
<?php

$url = 'https://joinposter.com/api/dash.getAnalytics' 
    . '?format=json'
    . '&token=687409:4164553abf6a031302898da7800b59fb'
    . '&dateFrom=20171009'
    . '&dateTo=20171012'
    . '&interpolate=week'
    . '&type=waiters';

$data = sendRequest($url);
```

> Пример ответа:

```json
{
  "response":{
    "data":[
      "169255.7100",
      "160327.7300",
      "48259.0100",
      "1470.0000"
    ],
    "data_hourly":[
      "36520.2400",
      "17785.4500",
      "19163.5600",
      "12688.5200",
      0,
      0,
      0,
      0,
      "13747.4500",
      "19465.3900",
      "8701.5900",
      "12727.5300",
      "12029.0000",
      "18482.3600",
      "18391.7200",
      "25149.2900",
      "23136.1600",
      "15255.1100",
      "14300.2800",
      "17448.0000",
      "28419.3000",
      "23969.5500",
      "19392.5800",
      "22539.3700"
    ],
    "data_weekday":[
      0,
      "169255.7100",
      "160327.7300",
      "48259.0100",
      "1470.0000",
      0,
      0
    ],
    "counters":{
      "revenue":"379312.4500",
      "profit":"315131.6900",
      "transactions":"248",
      "visitors":"744",
      "average_receipt":1535.6779352227,
      "average_time":"125.76268347"
    }
  }
}
```

```php
<?php

$url = 'https://joinposter.com/api/dash.getAnalytics'
    . '?format=json'
    . '&token=687409:4164553abf6a031302898da7800b59fb'
    . '&dateFrom=20171009'
    . '&dateTo=20171012'
    . '&interpolate=week'
    . '&type=waiters';

$data = sendRequest($url);
```

> Пример ответа:

```json
{
  "response":[
    {
      "user_id":"2",
      "name":"Максим",
      "sum":"5248550",
      "profit":"4505024",
      "revenue":"5522290",
      "clients":"42",
      "middle_time":"1871214.0370"
    },
    {
      "user_id":"6",
      "name":"Антон",
      "sum":"5873540",
      "profit":"5187174",
      "revenue":"6234086",
      "clients":"42",
      "middle_time":"3.2910"
    }
  ]
}
```

Метод возвращает статистику по продажам

### HTTP запрос

`GET https://joinposter.com/api/dash.getAnalytics`

### GET-параметры запроса dash.getAnalytics

Параметр | Описание
-------- | --------
dateFrom | Опциональный параметр, дата начала периода в формате `Ymd`. Если не указана, будут выданы все продажи за последние 30 дней от `dateTo`.
dateTo | Опциональный параметр, дата конца периода в формате `Ymd`. По умолчанию текущая дата.
interpolate | Опциональный параметр, вывод по: дням — day, неделям — week, месяцам — month. По умолчанию `day`. 
select | Опциональный параметр, тип выборки: оборот — `revenue`, прибыть — `profit`, средний чек — `average_receipt`, кол-во чеков — `transactions`, кол-во клиентов — `visitors`, среднее время — `average_time`. По умолчанию `revenue`.
type | Опциональный параметр, тип статистики: по официанту — waiters, цеху — workshops, категории — category, товару — products, заведению — spots, клиенту — clients. По умолчанию все.
id | Опциональный параметр, Id сущности по которой вернется выборка, например: id официанта, цеха, категории, товара, заведения, клиенту. По умолчанию — все.
business_day | Если `true` то статистика продаж будет возвращаться по тому бизнес дню, в который попадает `dateFrom` время. По умолчанию `false`.


В зависимости от значения параметра `type` предполагается разный формат ответа. 


### Параметры ответа dash.getAnalytics если type — waiters

Внутри параметра `response` лежит массив с объектами. Каждый объект содержит такие параметры:

Параметр | Описание
-------- | --------
user_id | Id сотрудника 
name | Имя сотрудника
sum | Сумма всех товаров по заказам для текущего официанта в гривнах
profit | Суммарная выручка по счетам  
revenue | Сумма реальных оплат по счетам
clients | Кол-во закрытых чеков
middle_time | Среднее время обслуживания заказа 


### Параметры ответа dash.getAnalytics если type — clients

Внутри параметра `response` лежит массив с объектами. Каждый объект содержит такие параметры:

Параметр | Описание
-------- | --------
client_id | Id клиента 
firstname | Имя клиента
lastname | Фамилия клиента
sum | Сумма всех товаров в каждом заказе в копейках
profit | Суммарная выручка по счетам
revenue | Сумма реальных оплат по счетам в копейках 
payed_cash | Сумма оплат наличными
payed_card | Сумма оплат картой
payed_third_party | Сумма оплат сторонними сервисами
clients | Кол-во закрытых чеков
phone | Телефон клиента
email | Эл. почта 


### Параметры ответа dash.getAnalytics если type — workshops, category, products, spots

Внутри параметра `response` лежит объект с параметрами:

Параметр | Описание
-------- | --------
data | Массив сумм продаж сгруппированных в зависимости от параметров `interpolate` и `type`
data_hourly | Массив значений разбитых по по часам. Сумма в гривнах.
data_weekday | Массив сумм продаж разбитых по дням недели. Сумма в гривнах.
counters | Счетчики основных показателей за данный период. Сумма в гривнах.
transaction_id | Номер транзакции.

Внутри параметра `сounters` лежит объект с параметрами:

Параметр | Описание
-------- | --------
revenue | Выручка в гривнах
profit | Прибыль в гривнах
transactions | Кол-во чеков
visitors | Кол-во гостей
average_receipt | Средний чек в гривнах
average_time | Среднее время закрытия чека в минутах
