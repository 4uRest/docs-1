# Интеграция сайта с Poster

Если у вас свой сайт, мобильное приложение, или чатбот для заказа блюд, настройте получение онлайн-заказов на терминал продаж Poster. 
И не тратьте время на создание чеков вручную для заказов с сайта. 
Пример идеальной интеграции, конструктор сайтов — [Poster Shop](https://joinposter.com/applications/poster-shop-production).

<iframe width="560" height="315" src="https://www.youtube.com/embed/5utm6zK3f2U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Подключение

### Если вы пишите интеграцию со своим сайтом

Чтобы отправлять заказы с сайта в Poster, вам нужен **access_token**.
Скопируйте его из админ-панели Poster во вкладке **Доступ → Интеграции** напротив приложения **Личная интеграция**.

<img src="/img/site/docs/my-site-token.jpg" alt="Токен в админ-панели Poster">


☝️ Не создавайте аккаунт разработчика, если вам не нужно следить когда заказ приняли или отклонили на кассе

☝️ Синхронизацию меню не обязательно делать. Вы можете один раз вручную проставить каким товарам на вашем сайте соответствуют. 

### Если вы пишите приложения для маркета

Вам нужно создать [приложение в аккаунте разработчика](/docs/v3/market/release) и написать [авторизацию через oAuth](/docs/v3/start/authApi). Клиент не должен вводить токен вручную.


## Синхронизация меню

Чтобы отправить онлайн-заказ в Poster вам нужно знать соответствие между товаром в вашем магазине и ID товара в Poster.
Есть несколько способов как сопоставить меню:

1. Удалить все меню в стороннем сервисе и заменить его на меню из Poster.
2. Сопоставить товары из Poster и стороннего сервиса по имени и дать клиенту подтвердить соответствие.

Выберите один из этих способов и используйте:

1. Метод [menu.getProducts](/docs/v3/web/menu/getProducts) чтобы получить все товары и тех. карты. Вам понадобится `product_id` для формирования заказа в Poster.
2. Метод [menu.getCategories](/docs/v3/web/menu/getCategories) чтобы получить все категории товаров и тех. карт
3. Подпишитесь на [вебхук product и dish](/docs/v3/web/webhooks) чтобы:
  - обновлять цены или названия товаров, когда их меняют в Poster.
  - добавлять новые товары к вам в меню
  - удалять товары
4. Когда приходит хук, в поле `object_id` передается его ID. Используйте метод [menu.getProduct](/docs/v3/web/menu/getProduct) чтобы получить всю информацию о товаре.

☝️ Чтобы не хранить связь между ID товара в Poster и товаром в вашей системе, используйте [extras product](/docs/v3/web/application/setEntityExtras).


## Отправка онлайн-заказов

Чтобы отправить заказ в Poster используйте метод [incomingOrders.createIncomingOrder](/docs/v3/web/incomingOrders/createIncomingOrder).
☝️ Если заказ уже оплатили на сайте передавайте параметр `payment`. Тогда в окне оплаты заказа, сумма к оплате будет 0 гривен.

Подпишитесь на [вебхук incoming_order](/docs/v3/web/webhooks). Хук приходит когда заказ:
  - отклоняют
  - принимают
  - закрывают чек созданный из онлайн-заказа

Все эти события вы можете синхронизировать со своей системой. Например, когда закрыли чек, отправлять клиенту сообщение что его заказ готово.

